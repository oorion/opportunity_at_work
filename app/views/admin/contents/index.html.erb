<div class="row">
  <%= form_for(:content, url:admin_contents_path, html: { class: "form-horizontal"} ) do |f| %>
    <h1 class="text-center">Create New Content </h1>
    <div class="form-group">
      <%= f.label :title, "Title", class: "col-sm-2 control-label" %>
      <%= f.text_area :title, placeholder: "Enter Descriptive Title", class: "col-sm-5" %>
    </div>

    <div class="form-group">
      <%= f.label :body, "Add New Content", class:"col-sm-2 control-label" %>
      <%= f.text_area :body, rows: 8, placeholder: "Write Descriptive Content For Site", class: "col-sm-5" %>
    </div>
    <br>
    <%= f.submit "Submit", class: "btn btn-primary col-sm-2 col-sm-offset-5" %>
  <% end %>
</div>

<div class="row table-index">
  <h3 class="text-center"> <u>All Content</u></h2>
  <label for="search_table"><strong>All Table Columns are Searchable by Keyword</strong></label><br>
  <input type="text" id="search_table" placeholder="keyword">

  <table class="table table-condensed">

    <thead>
    <tr class="warning">
      <th data-field='title'>Title </th>
      <th data-field='body'>Body </th>
      <th data-field="Edit/Delete">Edit/Delete</th>
    </tr>
    </thead>

    <tbody>
    <% @contents.each do |content| %>
      <tr id="table-row" data-title= "<%= content.title %>">
        <td><%= content.title %></td>
        <td><%= truncate(content.body, length: 17, separator: ' ') %></td>
        <td> <%= link_to "Edit", edit_admin_content_path(content), class: "btn btn-primary" %>
          <%= link_to "Delete", admin_content_path(content), method: :destroy, class: "btn btn-primary" %> </td>
      </tr>
    <% end %>
    </tbody>
  </table>
</div>

<script charset="utf-8">
  $(document).ready(function() {
    $('#search_table').keyup(function() {
      searchByColumn($(this).val());
    });
  });

  function searchByColumn(searchVal) {
    var table = $('.table-index')
    table.find('tr').each(function(index, row){
      var allDataPerRow = $(row).find('td');
      if (allDataPerRow.length > 0) {
        var found = false;
			  allDataPerRow.each(function(index, td) {
          var regExp = new RegExp(searchVal, "i");

          if(regExp.test($(td).text())) {
            found = true
            return false;
          }
        });
        if(found === true)$(row).show();
        else {
          $(row).hide();
        }
      }
    });
  }
</script>
